# üé¨ Ani-Light Backend

<p align="center">
  <img src="https://img.shields.io/badge/NestJS-E0234E?style=for-the-badge&logo=nestjs&logoColor=white" alt="NestJS" />
  <img src="https://img.shields.io/badge/TypeScript-007ACC?style=for-the-badge&logo=typescript&logoColor=white" alt="TypeScript" />
  <img src="https://img.shields.io/badge/PostgreSQL-316192?style=for-the-badge&logo=postgresql&logoColor=white" alt="PostgreSQL" />
  <img src="https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white" alt="Redis" />
  <img src="https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white" alt="Docker" />
</p>

<p align="center">
  <strong>Production-ready backend –¥–ª—è –∞–Ω–∏–º–µ —Å—Ç—Ä–∏–º–∏–Ω–≥ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</strong><br>
  –ú–æ—â–Ω—ã–π API —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å AniLibria
</p>

---

## üöÄ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### üéØ **Core Features**

- ‚úÖ **REST API** –¥–ª—è –∞–Ω–∏–º–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –ø–æ–ª–Ω–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- ‚úÖ **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** (Headers + HTTP-Only Cookies)
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫** (Free/Premium/VIP) –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º—ã
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AniLibria API** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ **Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üõ°Ô∏è **Security & Performance**

- ‚úÖ **Rate Limiting** (–º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ª–∏–º–∏—Ç—ã)
- ‚úÖ **Helmet Security Headers** + CORS
- ‚úÖ **Global Validation** –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **HTTP Retry Logic** –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
- ‚úÖ **Response Compression** (gzip)

### üìä **Monitoring & Logging**

- ‚úÖ **Prometheus Metrics** –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ **Winston Structured Logging** (—Ñ–∞–π–ª—ã + –∫–æ–Ω—Å–æ–ª—å)
- ‚úÖ **Health Check Endpoints** –¥–ª—è Kubernetes
- ‚úÖ **Database Indexes** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

### üß™ **Testing & Quality**

- ‚úÖ **Unit Tests** (23+ —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ **E2E Tests** –¥–ª—è API
- ‚úÖ **ESLint + Prettier** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ **TypeORM Migrations** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- **Node.js** >= 18.0.0
- **Yarn** >= 1.22.0
- **PostgreSQL** >= 14.0
- **Redis** >= 6.0

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ:

- **Docker** & **Docker Compose** (–¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)
- **Git** –¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

---

## üõ†Ô∏è –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd ani-light-backend

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
yarn install
```

### 2Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=ani_light_user
POSTGRES_PASSWORD=your_secure_password
POSTGRES_DB=ani_light_db

# üî¥ Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
REDIS_HOST=localhost
REDIS_PORT=6379

# üîê JWT —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# üåê API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
ANILIBRIA_API_URL=https://anilibria.top/api/v1
FRONTEND_URL=http://localhost:3000

# üìä –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
NODE_ENV=development
PORT=3001
LOG_LEVEL=info
```

### 3Ô∏è‚É£ –ó–∞–ø—É—Å–∫ —Å Docker (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–æ–∑–¥–∞–µ–º docker-compose.yml (—Å–º. –Ω–∏–∂–µ)
# –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up -d

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏
yarn typeorm:up

# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
yarn start:dev
```

### 4Ô∏è‚É£ –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –∏ Redis
# 2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
createdb ani_light_db

# 3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
yarn typeorm:up

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
yarn start:dev
```

---

## üê≥ Docker Compose

–°–æ–∑–¥–∞–π—Ç–µ `docker-compose.yml`:

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: ani_light_db
      POSTGRES_USER: ani_light_user
      POSTGRES_PASSWORD: your_secure_password
    ports:
      - '5432:5432'
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ['CMD-SHELL', 'pg_isready -U ani_light_user -d ani_light_db']
      interval: 10s
      timeout: 5s
      retries: 5

  redis:
    image: redis:7-alpine
    ports:
      - '6379:6379'
    volumes:
      - redis_data:/data
    healthcheck:
      test: ['CMD', 'redis-cli', 'ping']
      interval: 10s
      timeout: 5s
      retries: 5

volumes:
  postgres_data:
  redis_data:
```

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# üî• –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å hot-reload
yarn start:dev

# üèóÔ∏è –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
yarn build

# üöÄ –ü—Ä–æ–¥–∞–∫—à–Ω –∑–∞–ø—É—Å–∫
yarn start:prod

# üßπ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
yarn format

# üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–æ–º
yarn lint

# üîß –ê–≤—Ç–æ—Ñ–∏–∫—Å –ª–∏–Ω—Ç–µ—Ä–∞
yarn lint --fix
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

```bash
# üß™ Unit —Ç–µ—Å—Ç—ã
yarn test

# üîÑ Watch —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–æ–≤
yarn test:watch

# üåê E2E —Ç–µ—Å—Ç—ã
yarn test:e2e

# üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
yarn test:cov
```

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

```bash
# üìù –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
yarn typeorm:create src/migrations/migration-name

# üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
yarn typeorm:generate src/migrations/migration-name

# ‚¨ÜÔ∏è –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
yarn typeorm:up

# ‚¨áÔ∏è –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
yarn typeorm:down
```

---

## üì° API Endpoints

### üé¨ –ê–Ω–∏–º–µ –∫–æ–Ω—Ç–µ–Ω—Ç:

```http
GET    /anime                    # –°–ø–∏—Å–æ–∫ –∞–Ω–∏–º–µ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
GET    /anime/:id               # –î–µ—Ç–∞–ª–∏ –∞–Ω–∏–º–µ
GET    /anime/:id/episodes      # –≠–ø–∏–∑–æ–¥—ã –∞–Ω–∏–º–µ
GET    /anime/search?q=query    # –ü–æ–∏—Å–∫ –∞–Ω–∏–º–µ
```

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:

```http
POST   /auth/register           # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
POST   /auth/login              # –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
POST   /auth/logout             # –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
GET    /auth/profile            # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

```http
GET    /health                  # –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
GET    /health/live             # Liveness probe
GET    /health/ready            # Readiness probe
GET    /metrics                 # Prometheus –º–µ—Ç—Ä–∏–∫–∏
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–Ω–∏–º–µ
curl "http://localhost:3001/anime?page=1&limit=10"

# –ü–æ–∏—Å–∫ –∞–Ω–∏–º–µ
curl "http://localhost:3001/anime/search?q=–Ω–∞—Ä—É—Ç–æ"

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
curl -X POST "http://localhost:3001/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","username":"user","password":"password123"}'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
curl "http://localhost:3001/health"
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Environment Variables:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è          | –û–ø–∏—Å–∞–Ω–∏–µ            | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é            |
| ------------------- | ------------------- | ----------------------- |
| `POSTGRES_HOST`     | –•–æ—Å—Ç PostgreSQL     | `localhost`             |
| `POSTGRES_PORT`     | –ü–æ—Ä—Ç PostgreSQL     | `5432`                  |
| `POSTGRES_USER`     | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î     | -                       |
| `POSTGRES_PASSWORD` | –ü–∞—Ä–æ–ª—å –ë–î           | -                       |
| `POSTGRES_DB`       | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö     | -                       |
| `REDIS_HOST`        | –•–æ—Å—Ç Redis          | `localhost`             |
| `REDIS_PORT`        | –ü–æ—Ä—Ç Redis          | `6379`                  |
| `JWT_SECRET`        | –°–µ–∫—Ä–µ—Ç –¥–ª—è JWT      | -                       |
| `ANILIBRIA_API_URL` | URL AniLibria API   | -                       |
| `FRONTEND_URL`      | URL —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞       | `http://localhost:3000` |
| `NODE_ENV`          | –û–∫—Ä—É–∂–µ–Ω–∏–µ           | `development`           |
| `PORT`              | –ü–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è     | `3001`                  |
| `LOG_LEVEL`         | –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è | `info`                  |

### Rate Limiting:

- **Short**: 3 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫—É–Ω–¥–∞
- **Medium**: 20 –∑–∞–ø—Ä–æ—Å–æ–≤/10 —Å–µ–∫—É–Ω–¥
- **Long**: 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç–∞
- **Search**: 2 –∑–∞–ø—Ä–æ—Å–∞/—Å–µ–∫—É–Ω–¥–∞ (—Å—Ç—Ä–æ–∂–µ)

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤:

```
src/
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ anime/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ anime.service.spec.ts     # Unit —Ç–µ—Å—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ anime.controller.spec.ts  # Controller —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ user/
‚îÇ       ‚îî‚îÄ‚îÄ user.service.spec.ts      # Unit —Ç–µ—Å—Ç—ã
test/
‚îî‚îÄ‚îÄ app.e2e-spec.ts                   # E2E —Ç–µ—Å—Ç—ã
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
yarn test

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
yarn test --testPathPattern="\.spec\.ts$"

# –¢–æ–ª—å–∫–æ E2E —Ç–µ—Å—Ç—ã
yarn test:e2e

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
yarn test:cov

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
yarn test anime.service.spec.ts
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Prometheus –ú–µ—Ç—Ä–∏–∫–∏:

- `ani_light_http_requests_total` - –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `ani_light_http_request_duration_seconds` - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- `ani_light_active_connections` - –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `ani_light_cache_operations_total` - –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫—ç—à–µ–º
- `ani_light_external_api_requests_total` - –ó–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º API

### –õ–æ–≥–∏:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f logs/combined.log

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
tail -f logs/error.log

# –ü–æ–∏—Å–∫ –ø–æ –ª–æ–≥–∞–º
grep "ERROR" logs/combined.log
```

### Health Checks:

```bash
# –û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
curl http://localhost:3001/health

# –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–∞–±–æ—Ç–µ
curl http://localhost:3001/health/ready

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
curl http://localhost:3001/health/live

# –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
curl http://localhost:3001/health/external
```

---

## üöÄ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–Ω

### 1Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:

```bash
# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
yarn build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤
yarn test
yarn test:e2e

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞
yarn lint
```

### 2Ô∏è‚É£ Environment –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

```env
NODE_ENV=production
JWT_SECRET=super-secure-production-secret
POSTGRES_PASSWORD=secure-production-password
FRONTEND_URL=https://your-domain.com
LOG_LEVEL=warn
```

### 3Ô∏è‚É£ Docker –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
COPY yarn.lock ./
RUN yarn install --frozen-lockfile --production

COPY dist/ ./dist/
COPY logs/ ./logs/

EXPOSE 3001

CMD ["node", "dist/main"]
```

### 4Ô∏è‚É£ Kubernetes Health Checks:

```yaml
livenessProbe:
  httpGet:
    path: /health/live
    port: 3001
  initialDelaySeconds: 30
  periodSeconds: 10

readinessProbe:
  httpGet:
    path: /health/ready
    port: 3001
  initialDelaySeconds: 5
  periodSeconds: 5
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- üìñ **[JWT + Cookies Guide](docs/JWT_COOKIES_GUIDE.md)** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üèóÔ∏è **[Architecture Rules](.cursor/rules/)** - –ü—Ä–∞–≤–∏–ª–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- üîß **[API Documentation](http://localhost:3001/api)** - Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

---

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

```
src/
‚îú‚îÄ‚îÄ common/                    # –û–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ dto/                  # –û–±—â–∏–µ DTO
‚îÇ   ‚îú‚îÄ‚îÄ filters/              # Exception —Ñ–∏–ª—å—Ç—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ guards/               # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è guards
‚îÇ   ‚îú‚îÄ‚îÄ interceptors/         # Interceptors
‚îÇ   ‚îî‚îÄ‚îÄ services/             # –û–±—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
‚îú‚îÄ‚îÄ modules/                  # –ë–∏–∑–Ω–µ—Å –º–æ–¥—É–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ anime/               # –ú–æ–¥—É–ª—å –∞–Ω–∏–º–µ
‚îÇ   ‚îú‚îÄ‚îÄ episode/             # –ú–æ–¥—É–ª—å —ç–ø–∏–∑–æ–¥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ user/                # –ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ health/              # Health checks
‚îÇ   ‚îî‚îÄ‚îÄ metrics/             # Prometheus –º–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ migrations/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îî‚îÄ‚îÄ main.ts                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

### –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

1. **TypeScript Strict Mode** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
2. **ESLint + Prettier** - –µ–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–¥–∞
3. **Unit Tests** - –ø–æ–∫—Ä—ã—Ç–∏–µ –º–∏–Ω–∏–º—É–º 80%
4. **TypeORM API** - —Ç–æ–ª—å–∫–æ TypeORM –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è
6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –≤–∞–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è:

```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É
mkdir -p src/modules/feature-name/{dto,entities}

# 2. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã
touch src/modules/feature-name/feature.controller.ts
touch src/modules/feature-name/feature.service.ts
touch src/modules/feature-name/feature.module.ts
touch src/modules/feature-name/dto/feature.dto.ts
touch src/modules/feature-name/entities/feature.entity.ts

# 3. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç—ã
touch src/modules/feature-name/feature.service.spec.ts
touch src/modules/feature-name/feature.controller.spec.ts
```

---

## üêõ Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**1. –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å PostgreSQL
docker-compose ps postgres

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose logs postgres

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose down postgres
docker-compose up -d postgres
```

**2. –û—à–∏–±–∫–∞ Redis:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis
redis-cli ping

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
redis-cli flushall
```

**3. –û—à–∏–±–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
yarn typeorm:show

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
yarn typeorm:down

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
yarn typeorm:drop
yarn typeorm:up
```

**4. –ü—Ä–æ–±–ª–µ–º—ã —Å JWT:**

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å JWT_SECRET –≤ .env
echo $JWT_SECRET

# –û—á–∏—Å—Ç–∏—Ç—å cookies –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Incognito —Ä–µ–∂–∏–º
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- üêõ **Issues**: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ issue –≤ GitHub
- üìß **Email**: support@ani-light.com
- üí¨ **Discord**: [–°—Å—ã–ª–∫–∞ –Ω–∞ Discord —Å–µ—Ä–≤–µ—Ä]
- üìñ **Wiki**: [–°—Å—ã–ª–∫–∞ –Ω–∞ Wiki]

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ª–∏—Ü–µ–Ω–∑–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ MIT License - —Å–º. —Ñ–∞–π–ª [LICENSE](LICENSE) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

---

<p align="center">
  <strong>–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –∞–Ω–∏–º–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</strong>
</p>
